name: 'Auto Issue Labeling'

on:
  issues:
    types: [opened, edited]

permissions:
  contents: read
  issues: write

jobs:
  auto-label-issue:
    runs-on: ubuntu-latest
    steps:
      - name: Label issues based on title and body
        uses: actions/github-script@v7
        with:
          script: |
            const issue = context.payload.issue;
            const title = issue.title.toLowerCase();
            const body = (issue.body || '').toLowerCase();
            const labels = [];

            // Feature ë¼ë²¨
            if (title.match(/feat|feature|ê¸°ëŠ¥|êµ¬í˜„/) || 
                body.match(/ê¸°ëŠ¥|êµ¬í˜„/) || 
                title.includes('âœ¨')) {
              labels.push('âœ¨ feature');
            }

            // Chore ë¼ë²¨  
            if (title.match(/chore|ê¸°íƒ€|í™˜ê²½ì„¤ì •|ì„¤ì •/) || 
                body.match(/ê¸°íƒ€|í™˜ê²½ì„¤ì •|ì„¤ì •/) || 
                title.includes('ðŸŒ€')) {
              labels.push('ðŸŒ€ chore');
            }

            // Fix ë¼ë²¨
            if (title.match(/fix|ìˆ˜ì •|í•«í”½ìŠ¤/) || 
                body.match(/ìˆ˜ì •|í•«í”½ìŠ¤/) || 
                title.includes('ðŸ› ï¸')) {
              labels.push('ðŸ› ï¸ fix');
            }

            // Bug ë¼ë²¨
            if (title.match(/bug|ë²„ê·¸|ì˜¤ë¥˜|ì—ëŸ¬/) || 
                body.match(/ë²„ê·¸|ì˜¤ë¥˜|ì—ëŸ¬/) || 
                title.includes('ðŸž')) {
              labels.push('ðŸž bug');
            }

            // Refactor ë¼ë²¨
            if (title.match(/refactor|ë¦¬íŒ©í† ë§|êµ¬ì¡°\s*ê°œì„ /) || 
                body.match(/ë¦¬íŒ©í† ë§|êµ¬ì¡°\s*ê°œì„ /) || 
                title.includes('â™»ï¸')) {
              labels.push('â™»ï¸ refactor');
            }

            // Enhancement ë¼ë²¨
            if (title.match(/enhancement|ê°œì„ |ì„±ëŠ¥\s*í–¥ìƒ/) || 
                body.match(/ê°œì„ |ì„±ëŠ¥\s*í–¥ìƒ/) || 
                title.includes('â˜€ï¸')) {
              labels.push('â˜€ï¸ enhancement');
            }

            // Question ë¼ë²¨
            if (title.match(/question|ë¬¸ì˜|ì§ˆë¬¸|how\s*to/) || 
                body.match(/ë¬¸ì˜|ì§ˆë¬¸|how\s*to/) || 
                title.includes('â‰ï¸')) {
              labels.push('â‰ï¸ question');
            }

            // ë¼ë²¨ ì ìš©
            if (labels.length > 0) {
              await github.rest.issues.addLabels({
                owner: context.repo.owner,
                repo: context.repo.repo,
                issue_number: issue.number,
                labels: labels
              });
              
              console.log(`Applied labels: ${labels.join(', ')}`);
            } else {
              console.log('No matching labels found');
            }
